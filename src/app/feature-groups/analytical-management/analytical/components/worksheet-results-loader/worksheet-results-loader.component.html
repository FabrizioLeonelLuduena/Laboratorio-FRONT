<div class="worksheet-loader">
  <div *ngIf="!worksheetData">
    <button class="btn btn-primary" (click)="load()" [disabled]="loading">{{ loading ? 'Cargando...' : 'Cargar resultados' }}</button>
    <div *ngIf="error" class="error">{{ error }}</div>
  </div>

  <div *ngIf="worksheetData">
    <h2>{{ worksheetData.worksheetName }}</h2>

    <div class="analyses">
      <div *ngFor="let analysis of worksheetData.analyses" class="analysis-block">
        <app-worksheet-results-table
          [analysis]="analysis"
          [formValues]="formValues"
          (valueChange)="onCellChanged($event)">
        </app-worksheet-results-table>
      </div>
    </div>

    <div class="actions" style="margin-top: 16px;">
      <button class="btn btn-success" (click)="saveAll()">Guardar resultados</button>
      <button class="btn btn-secondary" (click)="cancel()" style="margin-left:8px;">Cancelar</button>
    </div>
  </div>
</div>

