@if (alertType !== null) {
  <app-generic-alert
    [type]="alertType"
    [title]="alertTitle"
    [text]="alertText"
    (closed)="alertType = null">
  </app-generic-alert>
}

<div class="flex flex-col min-h-[calc(100vh-13rem)] overflow-x-hidden px-8 py-4 text-[#003b4a] bg-white" *ngIf="!loading; else loadingTpl">
  <div class="w-full max-w-[1200px] mx-auto">
    <app-generic-form
      [fields]="formFields"
      [initialValue]="initialValue"
      [saving]="false"
      [maxCols]="gridColumns"
      [showHeader]="false"
      [showCancel]="false"
      [showSubmit]="false">
    </app-generic-form>

    <p-panel header="Items de la nota de entrega" [toggleable]="true" [collapsed]="false">
      <p-table [value]="details" [tableStyle]="{ 'min-width': '100%' }">
        <ng-template pTemplate="header">
          <tr>
            <th>Item</th>
            <th>Cantidad</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-detail>
          <tr>
            <td>{{ detail.supplierItemName }}</td>
            <td>{{ detail.receivedQuantity }}</td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="2" class="text-center p-4 text-muted">No hay items agregados.</td>
          </tr>
        </ng-template>
      </p-table>
    </p-panel>

    <div class="flex justify-start items-center pt-6">
      <app-generic-button
        type="back"
        icon="pi pi-arrow-left"
        (pressed)="onBack()">
      </app-generic-button>
    </div>
  </div>
</div>

<ng-template #loadingTpl>
  <div class="loading-state">Cargando nota de entrega...</div>
</ng-template>

<ng-template #noDetailsTpl>
  <div class="empty-state">La nota de entrega no tiene items registrados.</div>
</ng-template>
