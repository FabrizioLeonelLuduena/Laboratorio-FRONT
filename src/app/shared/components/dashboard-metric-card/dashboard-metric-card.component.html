<p-card class="h-full min-h-[160px] transition-all duration-200 hover:shadow-lg [&::ng-deep_.p-card]:h-full [&::ng-deep_.p-card]:flex [&::ng-deep_.p-card]:flex-col [&::ng-deep_.p-card-body]:flex [&::ng-deep_.p-card-body]:flex-col [&::ng-deep_.p-card-body]:flex-1">
  <div class="flex flex-col gap-4">
    <div class="flex items-start justify-between gap-3">
      <div 
        class="flex h-12 w-12 items-center justify-center rounded-lg bg-gradient-to-br from-[var(--surface-ground)] to-[var(--surface-border)] transition-transform hover:scale-110 shadow-sm">
        <i [ngClass]="[metric.icon, iconAccent(metric.accent)]" class="text-2xl"></i>
      </div>
      <p-button
        icon="pi pi-question-circle"
        [text]="true"
        [rounded]="true"
        [outlined]="true"
        size="small"
        class="shrink-0 w-7 h-7 min-w-7"
        (onClick)="openHelpModal()">
      </p-button>
    </div>

    <div class="flex flex-col gap-2">
      <h3 class="text-xs font-semibold text-[var(--on-surface-muted)] uppercase tracking-wider m-0 sm:text-sm">
        {{ metric.label }}
      </h3>
      
      <div class="flex items-baseline gap-2">
        <span class="text-2xl font-bold text-[var(--on-surface)] leading-none sm:text-[32px]">
          {{ metric.value }}
        </span>
      </div>

      <p class="text-[0.7rem] text-[var(--on-surface-muted)] m-0 leading-relaxed sm:text-xs">
        <i class="pi pi-clock text-[0.65rem] mr-1"></i>
        {{ metric.subtext }}
      </p>
    </div>
  </div>
</p-card>

<p-dialog
  [(visible)]="showHelpModal"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [style]="{ width: '450px', maxWidth: '90vw' }"
  [header]="metric.label">
  <div class="flex flex-col gap-3">
    <div class="flex items-start gap-3 p-3 bg-[var(--surface-ground)] rounded-lg border border-[var(--border-color)]">
      <i [ngClass]="[metric.icon, iconAccent(metric.accent)]" class="text-3xl mt-1"></i>
      <div class="flex-1">
        <p class="text-sm text-[var(--on-surface)] m-0 leading-relaxed">
          {{ metric.helpText }}
        </p>
      </div>
    </div>
  </div>
  <ng-template pTemplate="footer">
    <p-button
      label="Cerrar"
      icon="pi pi-times"
      [text]="true"
      (onClick)="closeHelpModal()">
    </p-button>
  </ng-template>
</p-dialog>
